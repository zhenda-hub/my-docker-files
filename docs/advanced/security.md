# 家庭 NAS 安全指南

> 本指南专为 NAS 爱好者设计，帮助你在家庭环境中最大限度保障数据与服务的安全，防范网络入侵、恶意软件、硬件损坏、账号泄露等多种风险。

---

## 🧱 1. 安全策略总览

| 领域   | 建议               | 风险防范          |
| ---- | ---------------- | ------------- |
| 网络安全 | 禁用不必要的外网访问、开启防火墙 | 防止黑客扫描与爆破     |
| 账户安全 | 强密码、限制登录、开启 2FA  | 防止密码泄露与账号盗用   |
| 数据安全 | 加密、版本控制、异地备份     | 防止数据丢失或勒索病毒攻击 |
| 系统安全 | 定期更新、只用可信源       | 防止漏洞与系统入侵     |
| 应用安全 | 限制容器权限、使用只读卷     | 防止应用层恶意操作     |

---

## 🔐 2. 网络安全设置

* 🚫 **关闭不必要的外网访问**：NAS 默认开放多个端口，应禁用公网访问，或使用 VPN 隧道访问
* 🔐 **配置防火墙**：限制端口访问（如只开放 22, 443），使用 GeoIP 限制访问区域
* 🛡️ **启用内网隔离**：将 NAS 放在 VLAN 或专用子网中，避免与主设备共享网络广播
* 🌐 **启用 HTTPS / 自签证书**：避免明文传输（如使用 Let’s Encrypt + Nginx Proxy）

---

## 👤 3. 用户与访问控制

* ✅ **创建最小权限账户**：不使用 admin/root 执行日常操作
* 🔒 **强密码 + 2FA（双因子验证）**：适用于 NAS 后台、SSH、Docker 管理平台等
* ⏱️ **自动锁定/限制登录尝试**：开启“登录失败锁定”，防止暴力破解
* 📋 **定期审计用户权限与登录记录**：清理不活跃用户、排查异常 IP 登录

---

## 🧊 4. 数据安全与备份

* 🗂️ **重要数据分区隔离**：工作文件与媒体内容分开存储
* 🔁 **开启快照/版本控制**：防止文件被误删或加密（如使用 Btrfs/ZFS 快照）
* 🔐 **加密重要目录**：通过 EncFS / VeraCrypt / native 加密机制保护核心数据
* 🌩️ **实施 3-2-1 备份策略**：参考 [备份指南](./nas_backup_guide.md)

---

## 🛠️ 5. 系统与服务安全

* 📦 **系统固件与软件保持更新**：及时修复已知安全漏洞（群晖/Unraid/OMV）
* ✅ **只从官方/可信源安装软件包**：避免恶意第三方脚本
* 🚨 **启用系统通知与异常警报**：如存储空间不足、系统负载异常、登录失败等
* 🧩 **Docker 安全建议**：

  * 使用 `read-only` 卷挂载配置文件
  * 禁止容器内使用 `--privileged`
  * 使用 `rootless` Docker 运行容器

---

## 🧬 6. 应用层保护（例如 immich、filebrowser 等）

* 更改默认端口，避免端口扫描（如将 3000 改为 33889）
* 使用反向代理（Nginx、Traefik）统一身份验证
* 启用访问日志与审计（如 FileBrowser 日志）
* 绑定特定内网地址运行服务，避免暴露在公网

---

## 🔍 7. 常用安全工具推荐

| 工具                 | 用途                   |
| ------------------ | -------------------- |
| **Fail2Ban**       | 自动封锁异常 SSH 登录 IP     |
| **CrowdSec**       | 行为感知型防御系统，增强防暴力破解能力  |
| **ClamAV**         | 开源杀毒软件，用于扫描上传文件和备份数据 |
| **Rclone 加密远程挂载**  | 对同步到云端的数据进行透明加密      |
| **Portainer** | 为 Docker 管理提供角色权限控制  |

---

## 🧠 8. 日常安全维护建议

* 每月手动检查一次外网开放端口
* 每季度更新所有 Docker 镜像并重建容器
* 定期手动测试备份恢复流程
* 备份账号密钥/2FA 恢复码，并离线保存
* 给重要服务启用登录通知（如邮件/Telegram Bot 推送）

---

## ✅ 总结

* 安全是一项系统工程，必须“最小权限 + 分层防御 + 自动监控”三位一体
* 只要 NAS 连上了网络，就不是“纯本地”——需视为公开资源管理
* 自动化 ≠ 安全，仍需人工审核、定期维护

> 数据可以丢，钱可以没，唯独你的家庭记忆、照片和隐私不能丢。

---

## 📚 延伸阅读

* [群晖官方安全建议](https://kb.synology.cn/zh-cn/DSM/tutorial/How_to_secure_Synology_NAS)
* [Docker 官方安全指南](https://docs.docker.com/engine/security/)
* [Unraid 安全最佳实践](https://wiki.unraid.net/Security)
* [OpenMediaVault 安全配置](https://wiki.omv-extras.org/)
* [Rclone 加密教程](https://rclone.org/crypt/)

